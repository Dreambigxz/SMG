<app-spinner></app-spinner>
<app-header2></app-header2>


	<div class="space-top container-fluid">



    <!-- <ng-template > -->
      <h2 class="title">Amount : {{currencySymbol}}{{totalAmount|number}} ~ <span class="text-info">${{totalAmountDollar|number}}</span></h2>

      <p></p>
      <div *ngIf="directory==='Withdraw'" class="withdraw">

				<!-- <p>Withdraw View </p> -->
        <div style="border-radius:15px" *ngFor="let tra of transaction;let i = index" class="bg-dark">
						<!-- <div *ngIf="tra.method!=='EGP'||tra.method==='EGP'&&tra.amount<=5000||username==='admin'"> -->
								<div  *ngIf="!['success','declined'].includes(tra.status)" class="container">
		              <div class="d-flex flex justify-content-between ">
		                <span class="label">ğŸ‘¨â€ğŸ’»:</span>
		                <span class="value">{{ tra.username }} </span>
		              </div>

									<div class="d-flex flex justify-content-between ">
		                <span class="label">AMOUNTâ€:</span>
		                <span class="value">{{tra.method}}{{ tra.init_amount|number }} </span>
		              </div>

		              <div class="d-flex flex justify-content-between ">
		                <span class="label">Time:</span>
		                <span class="value">{{ tra.timestamp|momentAgo }}</span>
		              </div>

		              <div class="d-flex flex justify-content-between ">
		                <span class="label">Status:</span>
		                <span
		                  class="value status"
		                  [ngClass]="{
		                    'status-pending': tra.status === 'pending',
		                    'status-confirmed': tra.status === 'Confirmed',
		                    'status-declined': tra.status === 'Declined'
		                  }"
		                >
		                  {{ tra.status }}
		                </span>
		              </div>


		              <div class="info-{{i}}">
		                <div (click)="copyContent(extraField(tra,'account_number'),'Account number copied')" class="d-flex flex justify-content-between ">
		                  <span class="label">Account:</span>
		                  <span class="value">{{ extraField(tra,'account_number')|truncateCenter }} <i  class="ti ti-copy"></i></span>
		                </div>

		                <div class="d-flex flex justify-content-between ">
		                  <span class="label">Name:</span>
		                  <span class="value">{{ extraField(tra,'account_holder') }}</span>
		                </div>

		                <div class="d-flex flex justify-content-between ">
		                  <span class="label">Bank:</span>
		                  <span class="value">{{ extraField(tra,'bank') }}</span>
		                </div>

		                <div class="button-group" *ngIf="tra.status === 'pending'">
		                  <button class="confirm" (click)="TransactionHandler(tra, 'success')">Confirm</button>
		                  <button class="decline" (click)="TransactionHandler(tra, 'declined')">Decline</button>
		                </div>
		              </div>
		              <!-- <div (click)="openDetails(tra,['info-'+i,'details-'+i])" class="proof details-{{i}}">
		                <a  class="post__more button button--purple button--ex-small">Details</a>
		              </div> -->
		          </div>
						<!-- </div> -->

        </div>

      </div>

      <div *ngIf="directory==='Deposit'" class="deposit">

        <div style="border-radius:15px"  *ngFor="let tra of transaction;let i = index" class="bg-dark text-white bordered">

            <div  *ngIf="!['success','declined'].includes(tra.status)" class="container">
              <div class="d-flex flex justify-content-between ">
                <span class="label">ğŸ‘¨â€ğŸ’»User:</span>
                <span class="value">{{ tra.username }} </span>
              </div>
							<div class="d-flex flex justify-content-between ">
                <span class="label">ğŸ¤‘AMOUNTâ€:</span>
                <span class="value">{{tra.method}}{{ tra.init_amount|number }} </span>
              </div>

              <div class="d-flex flex justify-content-between ">
                <span class="label">â°Time:</span>
                <span class="value">{{ tra.timestamp|momentAgo }}</span>
              </div>

              <div class="d-flex flex justify-content-between ">
                <span class="label">ğŸ“¥Status:</span>
                <span
                  class="value status"
                  [ngClass]="{
                    'status-pending': tra.status === 'pending',
                    'status-confirmed': tra.status === 'Confirmed',
                    'status-declined': tra.status === 'Declined'
                  }"
                >
                  {{ tra.status }}
                </span>
              </div>

							<div *ngIf='tra.proof' class=" d-flex flex justify-content-between">
                <span class="label">ğŸ§¾Receipt:</span>
                <span style="font-size:30px;" (click)="openPreview(tra)" class="value ">Open</span>
              </div>


              <div class="info-{{i}}">
                <div class="d-flex flex justify-content-between ">
                  <span class="label">REFERENCE ID:</span>
                  <span class="value">{{ tra.sessionID }} </span>
                </div>

                <div class="d-flex flex justify-content-between ">
                  <span class="label">Senders Name:</span>
                  <span class="value">{{ tra.transactionID }}</span>
                </div>

                <!-- <div  class="proof details-{{i}}">
                  <img class="proof-image" src="{{tra.file_url}}" alt="tra Proof" />
                </div> -->
                <!-- Thumbnail / Small Proof Image -->
                <!-- <img
                  [src]="tra.file_url"
                  alt="Proof of Payment"
                  class="thumbnail"
                  (click)="openPreview()"
                /> -->
                <!-- <a (click)="openPreview()" class="btn btn-secondary">Receipt</a> -->
								<!-- <button style="font-size:10px" (click)="openPreview()" type="button" name="button">Receipt</button> -->


                <!-- Modal Overlay -->
                <div class="modal-backdrop" *ngIf="previewVisible" (click)="closePreview()">
                  <div class="modal-content" (click)="$event.stopPropagation()">
                    <img [src]="currentProof" alt="Full Proof" />
                    <button class="close-button" (click)="closePreview()">âœ–</button>
                  </div>
                </div>


                <div class="button-group" *ngIf="tra.status === 'pending'">
                  <button class="confirm" (click)="TransactionHandler(tra, 'success')">Confirm</button>
                  <button class="decline" (click)="TransactionHandler(tra, 'declined')">Decline</button>
                </div>
              </div>

          </div>
        </div>

      </div>

			<div *ngIf="data" class="agent-card">

					<!-- <h3>ğŸ“¨ Agent Confirmation</h3> -->

					<!-- <div class="row">
						<span>ğŸ‘¤ AGENT:</span>
						<strong>{{data.username}}</strong>
					</div>

					<div class="row">
						<span>ğŸ’± Method:</span>
						<strong>{{data.method}} ({{data.symbol}})</strong>
					</div> -->

					<hr>

					<h4>ğŸ’° Balance Summary</h4>

					<div class="row">
						<span>Deposit:</span>
						<strong>{{data.symbol}}{{data.deposit | number}}</strong>
					</div>

					<div class="row">
						<span>Withdraw:</span>
						<strong>{{data.symbol}}{{data.withdraw | number}}</strong>
					</div>

					<div class="row">
						<span>Balance:</span>
						<strong>{{data.symbol}}{{data.balance | number}}</strong>
					</div>

					<hr>

					<h4>ğŸ“Š Settlement Details</h4>

					<div class="row">
						<span>Total Settled:</span>
						<strong>{{data.symbol}}{{data.total_settled | number}}</strong>
					</div>

					<div class="row">
						<span>Agent Balance:</span>
						<strong>{{data.symbol}}{{data.agent_bal | number}}</strong>
					</div>

					<div class="row">
						<span>Commission:</span>
						<strong>{{data.symbol}}{{data.commission | number:'1.2-2'}}</strong>
					</div>

					<div class="row">
						<span>Remit:</span>
						<strong>{{data.symbol}}{{data.remit | number:'1.2-2'}}</strong>
					</div>

					<div class="row">
						<span>USD Value:</span>
						<strong>${{data.usd}}</strong>
					</div>

					<hr>

					<!-- <div class="status">
						Status: {{data.path}}
					</div> -->

					</div>

  </div>
